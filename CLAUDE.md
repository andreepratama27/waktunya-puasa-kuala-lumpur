# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

```bash
pnpm dev        # Start dev server on port 3000
pnpm build      # Build for production
pnpm preview    # Preview production build
pnpm test       # Run tests with Vitest
pnpm lint       # Lint with Biome
pnpm format     # Format with Biome
pnpm check      # Lint + format check with Biome
```

## Architecture

**"Waktunya Puasa"** — a Ramadan prayer times app for Selangor, Malaysia (zone SGR01). Fetches weekly prayer timetable from the E-Solat API (`e-solat.gov.my`) and displays Imsak/Sahoor and Iftar (Maghrib) times with a live countdown to the next prayer.

**Stack:** TanStack Start (SSR React framework) + TanStack Router (file-based routing) + TanStack Query + Tailwind CSS v4 + Biome. Deployed on Netlify.

### Key files

- `src/routes/__root.tsx` — Root layout with `TanStackQueryProvider` wrapping all children. Devtools for Router and Query are embedded here.
- `src/routes/index.tsx` — The only route. Contains the server function (`fetchPrayerTime` via `createServerFn`), data normalization utilities (`normalizeRows`, `pickField`, `dayMap`), and the full UI including hero clock, Imsak/Iftar cards, daily prayer grid, and weekly table.
- `src/styles.css` — Global styles (not processed by Biome). Defines CSS variables (`--bg-deep`, `--glow`, etc.), the `.frost-card` glassmorphism utility, and `.page-wrap` with decorative dot-grid overlay. Fonts: Manrope (body) + Syne (headings).
- `src/integrations/tanstack-query/` — TanStack Query devtools and root provider boilerplate.
- `src/routeTree.gen.ts` — Auto-generated by TanStack Router; do not edit manually.

### Data flow

1. Route loader calls `fetchPrayerTime()` (server function) on each page load — no caching (`cache: "no-store"`).
2. Response is normalized by `normalizeRows()` which handles variable field names from the API (e.g., `fajr`/`subuh`, `dhuhr`/`zohor`).
3. `getFocusRow()` finds today's row by matching English day name; falls back to first row.
4. Client-side: a 1-second `setInterval` drives the live clock and next-prayer countdown (`formatDiff`).

### Import path alias

The `#/*` alias maps to `./src/*` (defined in `package.json` `imports` field). The `@/*` alias also maps to `./src/*` (defined in `tsconfig.json`).

### Biome configuration

- Indentation: tabs
- Quotes: double
- `src/routeTree.gen.ts` and `src/styles.css` are excluded from linting/formatting.
- Organize imports is enabled automatically.

### Specs

Product requirements and design reference live in `specs/` — `landing-page.md` and `landing-page-image.png`.
